<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title><%= title %></title>
  <link rel="icon" type="image/svg+xml" href="/student-favicon.svg" />
  <link rel="stylesheet" href="/css/style.css" />
</head>
<body>
  <%- include('../partials/header') %>

  <main class="main-content">
    <div class="jobs-container">
      <div class="jobs-header">
        <h1>Job Opportunities</h1>
        <p>Job openings recommended for: <strong><%= recommendedCareer %></strong></p>
      </div>

      <% if (jobs.length > 0) { %>
        <div class="jobs-list">
          <% jobs.forEach(job => { %>
            <div class="job-card">
              <div class="job-header">
                <h3><a href="/jobs/job/<%= job._id %>"><%= job.title %></a></h3>
                <span class="job-type"><%= job.jobType %></span>
              </div>
              <p class="company"><strong><%= job.company %></strong></p>
              <p class="location">üìç <%= job.location %></p>
              <p class="job-description"><%= job.description.substring(0, 120) %>...</p>
              <p class="salary"><strong>Salary:</strong> <%= job.salary %></p>
              <div class="job-actions">
                <a href="/jobs/job/<%= job._id %>" class="btn btn-secondary btn-sm">View Details</a>
                <button onclick="saveJob('<%= job._id %>')" class="btn btn-sm <%= savedJobIds.includes(job._id.toString()) ? 'saved' : '' %>">
                  <% if (savedJobIds.includes(job._id.toString())) { %>
                    ‚ù§Ô∏è Saved
                  <% } else { %>
                    ü§ç Save
                  <% } %>
                </button>
              </div>
            </div>
          <% }); %>
        </div>

        <!-- Pagination -->
        <% if (totalPages > 1) { %>
          <div class="pagination">
            <% if (currentPage > 1) { %>
              <a href="/jobs?page=1">First</a>
              <a href="/jobs?page=<%= currentPage - 1 %>">Previous</a>
            <% } %>
            <% for (let i = 1; i <= totalPages; i++) { %>
              <% if (i === currentPage) { %>
                <span class="page-current"><%= i %></span>
              <% } else { %>
                <a href="/jobs?page=<%= i %>"><%= i %></a>
              <% } %>
            <% } %>
            <% if (currentPage < totalPages) { %>
              <a href="/jobs?page=<%= currentPage + 1 %>">Next</a>
              <a href="/jobs?page=<%= totalPages %>">Last</a>
            <% } %>
          </div>
        <% } %>
      <% } else { %>
        <div class="no-jobs">
          <p>No job listings available at the moment.</p>
          <p>Check back soon for opportunities in <%= recommendedCareer %></p>
        </div>
      <% } %>

      <div class="jobs-footer">
        <a href="/jobs/saved" class="btn btn-secondary">View Saved Jobs</a>
      </div>
    </div>
  </main>

  <%- include('../partials/footer') %>

  <script src="/js/main.js"></script>
</body>
</html>
